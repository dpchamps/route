/*! Routejs 22-04-2014 */
!function(a){"use strict";var b=function(b){var c="ajax",d=".html",e={"default":{name:"index",node:void 0,callback:function(){}}};this.path=b.hasOwnProperty("path")?b.path:c,this.extension=b.hasOwnProperty("extension")?b.extension:d,this.routes=b.hasOwnProperty("routes")?b.routes:e,this.stateObject={page:""},this.currentRoute={},this.historyAPIsupport=!(!a.history||!a.history.pushState),this.captureHash=/#(.*)/,this.init()};b.prototype.init=function(){var b=this;this.historyAPIsupport&&(a.onpopstate=function(){var a=b.getRoute();a.name!==b.currentRoute.name&&b.setRoute(a)}),a.onhashchange=function(){var c=b.getRoute();c.name!==b.currentRoute.name?b.setRoute(c):a.location.hash=""},a.onload=function(){var a=b.getRoute();b.setRoute(a)}},b.prototype.getRoute=function(){var b,c=a.location.pathname.split("/"),d=c[c.length-1],e=a.location.hash;return b=""!==e?this.captureHash.exec(e)[1]:d,b=this.routes.hasOwnProperty(b)?this.routes[b]:this.routes.default},b.prototype.setRoute=function(b){this.currentRoute=b,this.stateObject.route=this.currentRoute.name,this.historyAPIsupport?a.history.replaceState(this.stateObject,this.currentRoute.name,this.currentRoute.name):a.location="#"+this.currentRoute.name,this.getPage(this.currentRoute)},b.prototype.getPage=function(b){var c=new a.XMLHttpRequest,d=this;c.open("GET",this.path+"/"+this.currentRoute.name+this.extension),c.onreadystatechange=function(){var e="",f="";if(4==c.readyState&&200==c.status){if("undefined"==typeof b.node){var g=a.document.createElement("div");g.innerHTML=c.responseText;var h=g.childNodes[0].getAttribute("id");if(null===h)return console.error(d.currentRoute.name,"does not have a node to attach to. Redirecting to default."),void d.setRoute(d.routes["default"]);e=h,f=g.childNodes[0].innerHTML}else e=b.node,f=c.responseText;if(null===a.document.getElementById(e))return console.error("Cannot find",e,"for",d.currentRoute.name,". Redirecting to default"),void d.setRoute(d.routes["default"]);a.document.getElementById(e).innerHTML=f,d.currentRoute.callback()}},c.send()},a.Route=b}(this);